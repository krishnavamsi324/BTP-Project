sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast"],function(e,t,o){"use strict";var r;return{onInit:function(){},onAfterItemAdded:function(e){debugger;var t=e.oSource.getModel().getServiceUrl();var o=e.getParameter("item");var n=window.location.href;var s=/college\([^)]*\)/;const i=n.match(s);if(i){r=i[0];console.log(r)}else{console.log("Number not found in URL")}var o=e.getParameter("item");var a={mediaType:o.getMediaType(),fileName:o.getFileName(),size:o.getFileObject().size};var l={url:t+r+"/coltofile",method:"POST",headers:{"Content-type":"application/json"},data:JSON.stringify(a)};return new Promise((e,t)=>{$.ajax(l).done((t,o,r)=>{e(t.ID)}).fail(e=>{t(e)})}).then(e=>{debugger;var r=t+`Files(ID=${e},IsActiveEntity=false)/content`;o.setUploadUrl(r);var n=this.byId("uploadSet");n.setHttpRequestMethod("PUT");n.uploadItem(o)}).catch(e=>{console.log(e)})},onUploadCompleted:function(e){debugger;var t=this.byId("uploadSet");t.removeAllIncompleteItems();t.getBinding("items");var o=e.oSource.mBindingInfos.items.binding.oContext;o.refresh()},onOpenPressed:async function(e){debugger;var t=e.oSource.getModel().getServiceUrl();var o=e.oSource.mProperties.url;let r;if(!o.startsWith(t)){r=t+e.oSource.mProperties.url}else{r=e.oSource.mProperties.url}const n=window.location.href;console.log("Current URL:",n);const s=new URL(n);const i=s.hash.substring(1);const a=/college\(lectId='([^']*)',IsActiveEntity=(true|false)\)/.exec(i);const l=a?a[2]==="true":null;var t=e.oSource.getModel().getServiceUrl();if(l===false){debugger;e.oSource.mProperties.url=r.replace("true","false")}else{e.oSource.mProperties.url=r}},onAfterItemRemoved:function(e){debugger;var t=e.oSource.getModel().getServiceUrl();var o=e.getParameter("item");var r=o.getBindingContext().getProperty("ID");var n=t+`Files(ID=${r},IsActiveEntity=false)`;$.ajax({url:n,method:"DELETE",success:function(){sap.m.MessageToast.show("File deleted successfully")}.bind(this),error:function(e){sap.m.MessageToast.show("Error deleting file");console.log("Error deleting file:",e)}})},onFileRenamed:function(e){debugger;var t=e.oSource.getModel().getServiceUrl();var o=e.getParameter("item");var r=o.getBindingContext().getProperty("ID");var n=t+`Files(ID=${r},IsActiveEntity=false)`;var s={fileName:sNewFileName};$.ajax({url:n,method:"PATCH",contentType:"application/json",data:JSON.stringify(s),success:function(){sap.m.MessageToast.show("File name updated successfully")},error:function(e){sap.m.MessageToast.show("Error updating file name");console.log("Error updating file name:",e)}})}}});
//# sourceMappingURL=Attachments.js.map